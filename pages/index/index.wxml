<!--index.wxml-->
<!-- å¯¼èˆªæ  -->
<navigation-bar title="PulseVyne" background="linear-gradient(135deg, #C6F8B2 0%, #76C893 50%, #4A7C59 100%)" color="#ffffff" back="{{false}}" homeButton="{{false}}"></navigation-bar>

<!-- ä¸»å®¹å™¨ -->
<view class="page-container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="header">
    <view class="logo-section">
      <image class="logo" src="https://free.picui.cn/free/2025/07/27/68850e2271ea1.png" mode="aspectFit"></image>
      <view class="app-name">PulseVyne</view>
      <view class="app-slogan">ç†è®ºåˆ°è¡ŒåŠ¨çš„æ™ºèƒ½è½¬åŒ–</view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <scroll-view class="main-content" scroll-y>
    <!-- ä»Šæ—¥æ¦‚è§ˆ -->
    <view class="overview-section">
      <view class="section-title">ä»Šæ—¥æ¦‚è§ˆ</view>
      <view class="overview-cards">
         <view class="overview-item">
           <view class="overview-number">{{todayStats.theoryCount}}</view>
           <view class="overview-label">ç†è®ºè®°å½•</view>
         </view>
         <view class="overview-item">
           <view class="overview-number">{{todayStats.actionCount}}</view>
           <view class="overview-label">è¡ŒåŠ¨ç”Ÿæˆ</view>
         </view>
         <view class="overview-item">
           <view class="overview-number">{{todayStats.executionCount}}</view>
           <view class="overview-label">æ‰§è¡Œå®Œæˆ</view>
         </view>
       </view>
    </view>

    <!-- æ€»æ¦‚è§ˆ -->
    <view class="total-overview-section">
      <view class="section-title">æ€»æ¦‚è§ˆ</view>
      <view class="total-overview-cards">
         <view class="total-overview-item">
           <view class="total-overview-number {{totalStats.loading ? 'loading' : ''}}">{{totalStats.loading ? '--' : totalStats.theoryCount}}</view>
           <view class="total-overview-label">ç†è®ºè®°å½•</view>
         </view>
         <view class="total-overview-item">
           <view class="total-overview-number {{totalStats.loading ? 'loading' : ''}}">{{totalStats.loading ? '--' : totalStats.actionCount}}</view>
           <view class="total-overview-label">è¡ŒåŠ¨ç”Ÿæˆ</view>
         </view>
         <view class="total-overview-item">
           <view class="total-overview-number {{totalStats.loading ? 'loading' : ''}}">{{totalStats.loading ? '--' : totalStats.executionCount}}</view>
           <view class="total-overview-label">æ‰§è¡Œå®Œæˆ</view>
         </view>
       </view>
    </view>

    <!-- å¾…æ‰§è¡Œæé†’ -->
    <view class="pending-reminder" wx:if="{{pendingAction}}">
      <view class="reminder-header">
        <view class="reminder-icon">â°</view>
        <view class="reminder-title">å¾…æ‰§è¡Œè¡ŒåŠ¨</view>
        <view class="reminder-badge">{{pendingHours}}å°æ—¶å‰</view>
      </view>
      <view class="reminder-content">
        <view class="reminder-text">{{pendingAction.title || pendingAction.description}}</view>
        <button class="reminder-btn" bindtap="navigateToExecution">
          <view class="btn-icon">â–¶ï¸</view>
          <view class="btn-text">ç«‹å³æ‰§è¡Œ</view>
        </button>
      </view>
    </view>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <view class="quick-actions">
      <button class="quick-btn primary" bindtap="quickAddTheory">
        <view class="btn-icon">âœ¨</view>
        <view class="btn-text">å¿«é€Ÿè®°å½•ç†è®º</view>
      </button>
      <button class="quick-btn secondary" bindtap="quickGenerateAction">
        <view class="btn-icon">ğŸš€</view>
        <view class="btn-text">ç”Ÿæˆè¡ŒåŠ¨å»ºè®®</view>
      </button>
      <button class="quick-btn test" bindtap="navigateToFeishuTest" wx:if="{{isSimulator}}">
        <view class="btn-icon">ğŸ§ª</view>
        <view class="btn-text">é£ä¹¦APIæµ‹è¯•</view>
      </button>
    </view>

    <!-- æœ€è¿‘æ´»åŠ¨ -->
    <view class="recent-section">
      <view class="section-header">
        <view class="section-title">æœ€è¿‘æ´»åŠ¨</view>
        <view class="section-subtitle">æŸ¥çœ‹æ‚¨çš„æœ€æ–°è¿›å±•</view>
      </view>
      <view class="recent-list">
        <view class="recent-item-wrapper" wx:for="{{recentActivities}}" wx:key="id">
          <view class="recent-item" bindtap="onActivityTap" bindlongpress="deleteActivity" data-index="{{index}}" data-id="{{item.id}}">
            <view class="activity-icon">{{item.icon}}</view>
            <view class="activity-content">
              <view class="activity-title">{{item.title}}</view>
              <view class="activity-desc">{{item.description}}</view>
              <view class="activity-time">{{item.time}}</view>
            </view>
          </view>
        </view>
        <view class="recent-item empty" wx:if="{{recentActivities.length === 0}}">
          <view class="activity-icon">ğŸ“</view>
          <view class="activity-content">
            <view class="activity-title">æš‚æ— æ´»åŠ¨è®°å½•</view>
            <view class="activity-desc">å¼€å§‹è®°å½•æ‚¨çš„ç¬¬ä¸€ä¸ªç†è®ºå§ï¼</view>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>
</view>

<!-- åº•éƒ¨å¯¼èˆªæ  -->
<view class="bottom-nav {{navFixed ? 'fixed' : ''}}" bindtouchstart="onTouchStart">
  <view class="nav-item {{currentPage === 'theory' ? 'active' : ''}}" bindtap="navigateToTheory">
    <view class="nav-icon">ğŸ“</view>
    <view class="nav-label">ç†è®ºè®°å½•</view>
  </view>
  <view class="nav-item {{currentPage === 'action' ? 'active' : ''}}" bindtap="navigateToAction">
    <view class="nav-icon">ğŸ¯</view>
    <view class="nav-label">è¡ŒåŠ¨ç”Ÿæˆ</view>
  </view>
  <view class="nav-item {{currentPage === 'execution' ? 'active' : ''}}" bindtap="navigateToExecution">
    <view class="nav-icon">âœ…</view>
    <view class="nav-label">æ‰§è¡Œè®°å½•</view>
  </view>
  <view class="nav-item {{currentPage === 'progress' ? 'active' : ''}}" bindtap="navigateToProgress">
    <view class="nav-icon">ğŸ“Š</view>
    <view class="nav-label">è¿›å±•åé¦ˆ</view>
  </view>
  <view class="nav-item {{currentPage === 'achievement' ? 'active' : ''}}" bindtap="navigateToAchievement">
    <view class="nav-icon">ğŸ†</view>
    <view class="nav-label">æˆå°±å±•å…</view>
  </view>
</view>
