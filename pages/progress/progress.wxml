<!--è¿›å±•åé¦ˆé¡µé¢-->
<navigation-bar title="è¿›å±•åé¦ˆ" background="linear-gradient(135deg, #C6F8B2 0%, #76C893 50%, #4A7C59 100%)" color="#ffffff" back="{{true}}" homeButton="{{true}}"></navigation-bar>

<view class="container">

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <scroll-view class="main-content" scroll-y="true">
    <!-- æ‰§è¡Œæ€»ç»“ -->
    <view class="summary-section">
      <view class="section-title">
        <text class="title-icon">ğŸ“Š</text>
        <text class="title-text">æ‰§è¡Œæ€»ç»“</text>
      </view>
      <view class="summary-card">
        <view class="summary-item">
          <text class="summary-label">æœ¬å‘¨æ‰§è¡Œæ¬¡æ•°</text>
          <text class="summary-value">{{weeklyCount}}æ¬¡</text>
        </view>
        <view class="summary-item">
          <text class="summary-label">å¹³å‡è¯„åˆ†</text>
          <text class="summary-value">{{averageRating}}/5</text>
        </view>
        <view class="summary-item">
          <text class="summary-label">å®Œæˆç‡</text>
          <text class="summary-value">{{completionRate}}%</text>
        </view>
      </view>
    </view>

    <!-- è¶‹åŠ¿åˆ†æ -->
    <view class="trend-section">
      <view class="section-title">
        <text class="title-icon">ğŸ“ˆ</text>
        <text class="title-text">è¶‹åŠ¿åˆ†æ</text>
      </view>
      <view class="trend-card">
        <view class="trend-chart">
          <!-- ç®€å•çš„è¶‹åŠ¿å›¾è¡¨ç¤º -->
          <view class="chart-container">
            <view class="chart-bar" wx:for="{{trendData}}" wx:key="index" style="height: {{item.height}}%">
              <text class="bar-label">{{item.label}}</text>
            </view>
          </view>
        </view>
        <view class="trend-description">
          <text class="trend-text">{{trendDescription}}</text>
        </view>
      </view>
    </view>

    <!-- AI åé¦ˆå»ºè®® -->
    <view class="feedback-section">
      <view class="section-title">
        <text class="title-icon">ğŸ¤–</text>
        <text class="title-text">AI åé¦ˆå»ºè®®</text>
      </view>
      <view class="feedback-card">
        <view wx:if="{{isGeneratingFeedback}}" class="loading-feedback">
          <view class="loading-spinner"></view>
          <text class="loading-text">AIæ­£åœ¨åˆ†ææ‚¨çš„æ‰§è¡Œæƒ…å†µ...</text>
        </view>
        <view wx:else class="feedback-content">
          <view class="feedback-item" wx:for="{{aiFeedback}}" wx:key="index">
            <view class="feedback-type {{item.type}}">
              <text class="feedback-icon">{{item.icon}}</text>
              <text class="feedback-label">{{item.label}}</text>
            </view>
            <text class="feedback-text">{{item.content}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ”¹è¿›å»ºè®® -->
    <view class="improvement-section">
      <view class="section-title">
        <text class="title-icon">ğŸ’¡</text>
        <text class="title-text">æ”¹è¿›å»ºè®®</text>
      </view>
      <view class="improvement-card">
        <view class="improvement-item" wx:for="{{improvements}}" wx:key="index">
          <view class="improvement-header">
            <text class="improvement-title">{{item.title}}</text>
            <text class="improvement-priority {{item.priority}}">{{item.priorityText}}</text>
          </view>
          <text class="improvement-description">{{item.description}}</text>
          <view class="improvement-actions">
            <button class="action-btn" bindtap="adoptSuggestion" data-index="{{index}}">é‡‡çº³å»ºè®®</button>
            <button class="action-btn secondary" bindtap="ignoreSuggestion" data-index="{{index}}">æš‚æ—¶å¿½ç•¥</button>
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’®ç»„ -->
    <view class="action-buttons">
      <button class="action-button primary" bindtap="generateNewFeedback">
        <text class="button-icon">ğŸ”„</text>
        <text class="button-text">é‡æ–°ç”Ÿæˆåé¦ˆ</text>
      </button>
      <button class="action-button" bindtap="copyProgressReport">
        <text class="button-icon">ğŸ“‹</text>
        <text class="button-text">å¤åˆ¶æŠ¥å‘Š</text>
      </button>
      <button class="action-button secondary" open-type="share">
        <text class="button-icon">ğŸ“¤</text>
        <text class="button-text">åˆ†äº«è¿›å±•</text>
      </button>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <view class="bottom-nav {{navFixed ? 'fixed' : ''}}" bindtouchstart="onTouchStart">
    <view class="nav-item {{currentPage === 'theory' ? 'active' : ''}}" bindtap="navigateToTheory">
      <view class="nav-icon">ğŸ“</view>
      <view class="nav-label">ç†è®ºè®°å½•</view>
    </view>
    <view class="nav-item {{currentPage === 'action' ? 'active' : ''}}" bindtap="navigateToAction">
      <view class="nav-icon">ğŸ¯</view>
      <view class="nav-label">è¡ŒåŠ¨ç”Ÿæˆ</view>
    </view>
    <view class="nav-item {{currentPage === 'execution' ? 'active' : ''}}" bindtap="navigateToExecution">
      <view class="nav-icon">âœ…</view>
      <view class="nav-label">æ‰§è¡Œè®°å½•</view>
    </view>
    <view class="nav-item {{currentPage === 'progress' ? 'active' : ''}}" bindtap="navigateToProgress">
      <view class="nav-icon">ğŸ“Š</view>
      <view class="nav-label">è¿›å±•åé¦ˆ</view>
    </view>
    <view class="nav-item {{currentPage === 'achievement' ? 'active' : ''}}" bindtap="navigateToAchievement">
      <view class="nav-icon">ğŸ†</view>
      <view class="nav-label">æˆå°±å±•å…</view>
    </view>
  </view>
</view>