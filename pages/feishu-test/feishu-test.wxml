<!--é£ä¹¦æµ‹è¯•é¡µé¢-->
<view class="container">
  <!-- å¯¼èˆªæ  -->
  <view class="navigation-bar" style="background: linear-gradient(135deg, #C6F8B2 0%, #76C893 50%, #4A7C59 100%);">
    <view class="nav-content">
      <view class="nav-left" bindtap="goHome">
        <view class="home-icon"></view>
      </view>
      <view class="nav-title">ğŸ§ª é£ä¹¦APIæµ‹è¯•</view>
      <view class="nav-right"></view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <view class="main-content">
    <!-- è¿æ¥æµ‹è¯•åŒºåŸŸ -->
    <view class="test-section">
      <view class="section-title">
        <text class="title-icon">ğŸ”—</text>
        <text class="title-text">è¿æ¥æµ‹è¯•</text>
        <view class="status-indicator status-{{connectionStatus}}"></view>
      </view>
      
      <view class="test-card">
        <view class="card-desc">æµ‹è¯•é£ä¹¦APIè¿æ¥çŠ¶æ€</view>
        <button 
          class="test-btn {{isTestingConnection ? 'loading' : ''}}" 
          bindtap="testConnection"
          disabled="{{isTestingConnection}}"
        >
          {{isTestingConnection ? 'æµ‹è¯•ä¸­...' : 'æµ‹è¯•è¿æ¥'}}
        </button>
      </view>
    </view>

    <!-- è®°å½•åˆ›å»ºæµ‹è¯•åŒºåŸŸ -->
    <view class="test-section">
      <view class="section-title">
        <text class="title-icon">ğŸ“</text>
        <text class="title-text">è®°å½•åˆ›å»ºæµ‹è¯•</text>
      </view>
      
      <view class="test-card">
        <!-- åˆ—ç±»å‹é€‰æ‹© -->
        <view class="form-item">
          <view class="form-label">é€‰æ‹©åˆ—ç±»å‹:</view>
          <picker 
            range="{{lineTypes}}" 
            value="{{selectedLineId}}"
            bindchange="onLineTypeChange"
            class="picker"
          >
            <view class="picker-text">{{selectedLineId}}</view>
          </picker>
        </view>

        <!-- æµ‹è¯•æ–‡æœ¬è¾“å…¥ -->
        <view class="form-item">
          <view class="form-label">æµ‹è¯•æ–‡æœ¬:</view>
          <textarea 
            class="test-input"
            placeholder="è¯·è¾“å…¥æµ‹è¯•æ–‡æœ¬å†…å®¹"
            value="{{testText}}"
            bindinput="onTestTextChange"
            maxlength="500"
          ></textarea>
        </view>

        <button 
          class="test-btn primary {{isCreatingRecord ? 'loading' : ''}}" 
          bindtap="createTestRecord"
          disabled="{{isCreatingRecord}}"
        >
          {{isCreatingRecord ? 'åˆ›å»ºä¸­...' : 'åˆ›å»ºè®°å½•'}}
        </button>
      </view>
    </view>

    <!-- æµ‹è¯•ç»“æœåŒºåŸŸ -->
    <view class="test-section">
      <view class="section-title">
        <text class="title-icon">ğŸ“Š</text>
        <text class="title-text">æµ‹è¯•ç»“æœ</text>
        <view class="title-actions">
          <text class="clear-btn" bindtap="clearTestResults" wx:if="{{testResults.length > 0}}">æ¸…ç©º</text>
        </view>
      </view>
      
      <view class="results-container" wx:if="{{testResults.length > 0}}">
        <view 
          class="result-item result-{{item.success ? 'success' : 'failed'}}"
          wx:for="{{testResults}}"
          wx:key="timestamp"
          bindtap="viewResultDetail"
          data-index="{{index}}"
        >
          <view class="result-header">
            <view class="result-type">
              <text class="type-icon">{{item.type === 'connection' ? 'ğŸ”—' : 'ğŸ“'}}</text>
              <text class="type-text">{{item.type === 'connection' ? 'è¿æ¥æµ‹è¯•' : 'åˆ›å»ºè®°å½•'}}</text>
            </view>
            <view class="result-status">
              <text class="status-icon">{{item.success ? 'âœ…' : 'âŒ'}}</text>
            </view>
          </view>
          
          <view class="result-content">
            <view class="result-message">{{item.message}}</view>
            <view class="result-time">{{item.timestamp}}</view>
            <view class="result-line" wx:if="{{item.lineId}}">åˆ—: {{item.lineId}}</view>
          </view>
          
          <view class="result-actions">
            <text class="action-btn" catchtap="copyResult" data-index="{{index}}">å¤åˆ¶</text>
          </view>
        </view>
      </view>
      
      <view class="empty-results" wx:else>
        <view class="empty-icon">ğŸ“‹</view>
        <view class="empty-text">æš‚æ— æµ‹è¯•ç»“æœ</view>
        <view class="empty-desc">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•</view>
      </view>
    </view>
  </view>
</view>